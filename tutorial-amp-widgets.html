<!DOCTYPE html>
<html lang="en">

<head>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create', 'UA-66074042-1', 'auto');ga('send', 'pageview');</script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AMP Library AMP Widgets Configuration</title>

  <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="./build/entry.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,400,700|Inconsolata,700" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css">
  <link type="text/css" rel="stylesheet" href="styles/app.min.css">
  <link type="text/css" rel="stylesheet" href="styles/iframe.css">
  <link type="text/css" rel="stylesheet" href="">
  <script async defer src="https://buttons.github.io/buttons.js"></script>

  
</head>



<body class="layout">
    <div id="stickyNavbarOverlay"></div>
    

<div class="top-nav">
    <div class="inner">
        <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
        <div class="logo">
             
                <a class="image" href="index.html">
                    <img src="https://images.assettype.com/quintype-website/2018-10/013e8cbe-92b4-435f-bbbb-3e101efbc99a/quintype_logo.png?w=180" alt="logo">
                </a>
            
            
        </div>
        <div class="menu">
            
            <div class="navigation">
                <a
                    href="index.html"
                    class="link"
                >
                    API Documentation
                </a>
                <div class="dropdown is-hoverable is-right">
                    <a class="dropdown-trigger link">
                        Tutorials
                        <i class="fas fa-chevron-down fa-xs"></i>
                    </a>
                    <div class="dropdown-menu">
                        <div class="dropdown-content">
                        
                            
                                <a class="dropdown-item" href="tutorial-overview.html">
                                    Overview
                                </a>
                            
                                <a class="dropdown-item" href="tutorial-opts.html">
                                    The 'opts' object
                                </a>
                            
                                <a class="dropdown-item" href="tutorial-localization.html">
                                    Localization
                                </a>
                            
                                <a class="dropdown-item" href="tutorial-default-story-templates.html">
                                    Default Story Templates
                                </a>
                            
                                <a class="dropdown-item" href="tutorial-custom-story-templates.html">
                                    Custom Story Templates
                                </a>
                            
                                <a class="dropdown-item" href="tutorial-library-exports.html">
                                    AMP Library Exports
                                </a>
                            
                                <a class="dropdown-item" href="tutorial-migration-to-v2.html">
                                    Migration from @quintype/framework v3.x.x to v4.x.x
                                </a>
                            
                                <a class="dropdown-item" href="tutorial-features.html">
                                    Features
                                </a>
                            
                                <a class="dropdown-item" href="tutorial-amp-widgets.html">
                                    AMP Widgets Configuration
                                </a>
                            
                        
                        </div>
                    </div>
                </div>
                
                
            </div>
        </div>
    </div>
</div>
    <div id="main">
        <div
            class="sidebar tutorials"
            id="sidebarNav"
        >
            
                <div class="search-wrapper">
                    <input id="search" type="text" placeholder="Search docs..." class="input">
                </div>
            
            <nav>
                
                    <div class="category"><h3>Tutorials</h3><ul><li><a href="tutorial-overview.html">Overview</a></li><li><a href="tutorial-opts.html">The 'opts' object</a></li><li><a href="tutorial-localization.html">Localization</a></li><li><a href="tutorial-default-story-templates.html">Default Story Templates</a></li><li><a href="tutorial-custom-story-templates.html">Custom Story Templates</a></li><li><a href="tutorial-library-exports.html">AMP Library Exports</a></li><li><a href="tutorial-migration-to-v2.html">Migration from @quintype/framework v3.x.x to v4.x.x</a></li><li><a href="tutorial-features.html">Features</a></li><li><a href="tutorial-amp-widgets.html">AMP Widgets Configuration</a></li></ul></div>
                
            </nav>
        </div>
        <div class="core" id="main-content-wrapper">
            <div class="content">
                <header class="page-title">
                    <p>Tutorial</p>
                    <h1>AMP Widgets Configuration</h1>
                </header>
                <section>

<header>
    
</header>

<article>
    <h1>AMP Widgets Configuration</h1>
<p>AMP widgets can be configured in two ways: through the Page Builder (PB) UI or via custom configuration for publishers.</p>
<h2>Page Builder Configuration</h2>
<p>Page Builder provides an option to configure widgets directly through the UI. This is the standard way to manage widgets for stories.</p>
<h2>Custom Publisher Configuration</h2>
<p>For custom publishers, you can provide the widget configuration through <code>ampConfig</code> in your <code>ampRoutes</code> setup. This allows for dynamic or code-based widget definitions.</p>
<h3>Example Configuration</h3>
<p>You can pass a <code>customAmpWidgets</code> function to the <code>ampRoutes</code> configuration. This function should return an array of widget objects.</p>
<pre class="prettyprint source lang-javascript"><code>ampRoutes(app, {
  getAdditionalConfig: additionalConfigGetter,
  enableAmp: (config) => get(config, ['pbConfig', 'general', 'amp', 'amp-story-pages'], true),
  customAmpWidgets: getCustomWidgetsForAmpStory,
  // ... other options
});

function getCustomWidgetsForAmpStory() {
  const customWidgets = [
    {
      &quot;enable&quot; : true,
      'code': `&lt;amp-fx-flying-carpet height=&quot;300px&quot;>
                      &lt;amp-ad width=&quot;300&quot; height=&quot;600&quot; layout=&quot;fixed&quot;
                        type=&quot;doubleclick&quot;
                        data-slot=&quot;/5463099287/PB-AMP-300x600&quot;
                        data-loading-strategy=&quot;prefer-viewability-over-views&quot;>
                      &lt;/amp-ad>
                    &lt;/amp-fx-flying-carpet>`
    },
    {
      &quot;enable&quot; : true,
      'code': `&lt;amp-ad
      width=&quot;300&quot;
      height=&quot;200&quot;
      layout=&quot;fixed&quot;
      type=&quot;doubleclick&quot;
      data-slot=&quot;/5463099287/PB-AMP-300x200&quot;
      data-loading-strategy=&quot;prefer-viewability-over-views&quot;>&lt;/amp-ad>`
    },
   ....
  ];

  return customWidgets;
}
</code></pre>
<p>The <code>customAmpWidgets</code> function is executed safely, so any errors thrown within it will be caught and logged, preventing the application from crashing.</p>
<h3>Required Scripts</h3>
<p>Ensure that you include the necessary AMP scripts in the <code>&lt;head&gt;</code> of your <code>layout.ejs</code> file for the components you are using.</p>
<pre class="prettyprint source lang-html"><code>&lt;script async custom-element=&quot;amp-ad&quot; src=&quot;https://cdn.ampproject.org/v0/amp-ad-0.1.js&quot;>&lt;/script>
&lt;script async custom-element=&quot;amp-fx-flying-carpet&quot; src=&quot;https://cdn.ampproject.org/v0/amp-fx-flying-carpet-0.1.js&quot;>&lt;/script>
</code></pre>
<h2>Scope (Phase 1)</h2>
<h3>In-Scope</h3>
<ul>
<li><strong>Custom Components</strong>: Ability to insert custom AMP components in up to 6 slots (after story card 1â€“6).</li>
<li><strong>Allowed Types</strong>: Widgets give flexibility to add any type. Adding valid types will always work, while adding invalid AMP HTML tags can cause unpredictable behavior (e.g., ads not showing up or AMP page traffic dipping).</li>
<li><strong>No Validation</strong>: There is no validation of AMP code done on Amp Library side.</li>
<li><strong>Coexistence</strong>: The BOLD ads (Header, Footer &amp; Body-Ad) will coexist with the ads/widgets served via the Custom publisher FE App / PB functionality.</li>
</ul>
<h3>Out of Scope</h3>
<ul>
<li><strong>Individual Story Configuration</strong>: Individual story type ad configuration is not supported.</li>
<li><strong>Header/Footer Configuration</strong>: Header/footer ad configuration is still controlled by BOLD only.</li>
<li><strong>Validation</strong>: No AMP-validation checks.</li>
<li><strong>Preview</strong>: No PB Preview for AMP ads.</li>
</ul>
<h2>Functional Requirements</h2>
<ul>
<li><strong>Positions</strong>: PB will support 6 positions: After Card 1, 2... to 6.</li>
<li><strong>Global Settings</strong>: These are global settings applied to all AMP articles, present in the current custom code layout under AMP configuration settings.</li>
<li><strong>Slot Logic</strong>: If a story has fewer than X cards, that slot is simply ignored (AMP code is not rendered).</li>
<li><strong>Existing Ads</strong>: Header and footer ads continue to be injected only by BOLD.</li>
<li><strong>Input Format</strong>: PB allows publishers to paste AMP-compatible HTML in a multi-line input field.</li>
<li><strong>Supported Patterns</strong>: Includes any AMP compatible/valid types.</li>
</ul>
<h2>Risks to be Considered</h2>
<ul>
<li><strong>Validation Failures</strong>: Pages may fail AMP validation if publishers paste invalid components.</li>
<li><strong>Layout Shifts</strong>: Excessive ad inserts may cause layout shifts or violate Google AMP policies.</li>
<li><strong>Misunderstanding</strong>: Publishers may misunderstand that &quot;position = exact appearance&quot;.</li>
</ul>
<h2>Additional Dev Notes</h2>
<ul>
<li><strong>Rendering</strong>: We can render any tags passed from custom widgets. Whether they work as expected depends on if the widget code added is AMP compliant.
<ul>
<li><em>Example</em>: If the publisher adds <code>amp-sticky-ad</code> in the widget and forgets to add the required script in the head, we will render the widget but no ad is loaded.</li>
</ul>
</li>
<li><strong>Ad Limits</strong>: The AMP library itself doesn't restrict the number of ads. The ad provider may choose not to serve many creatives.</li>
</ul>
</article>

</section>

            </div>
            
            <footer class="footer">
                <div class="content has-text-centered">
                    <p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.11</a></p>
                    <p class="sidebar-created-by">
                        <a href="https://github.com/SoftwareBrothers/better-docs" target="_blank">BetterDocs theme</a> provided with <i class="fas fa-heart"></i> by 
                        <a href="http://softwarebrothers.co" target="_blank">SoftwareBrothers - JavaScript Development Agency</a>
                    </p>
                </div>
            </footer>
            
        </div>
        <div id="side-nav" class="side-nav">
        </div>
    </div>
<script src="scripts/app.min.js"></script>
<script>PR.prettyPrint();</script>
<script src="scripts/linenumber.js"> </script>

<script src="scripts/search.js"> </script>

</body>
</html>