The AMP library accepts customizations via the "opts" javascript object. These are all optional.

## AMP story pages

The opts object for rendering AMP story pages has the following structure:

```jsx
const myStoryPageOptsObj = {
  seo,
  templates,
  slots,
  ...
  ..renders..
  ...
};
```

- `seo` - this is the SEO object generated by [quintype/seo](https://developers.quintype.com/quintype-node-seo/)
- `templates` - pass your custom story templates here. If not passed, the default templates will be used
- `slots` - config for story page slots
- renders - umbrella term used for the different render props used to customize the default templates.
  - `storyElementRender`
  - `relatedStoriesRender`
  - `headerCardRender`
  - `infiniteScrollRender`

<hr />
This section is useful if you want to use custom templates. Else, jump to <a href="#slots_link">slots</a>

#### Passing custom templates

Pass an object containing your custom templates to the `templates` key of the `opts` object.
This is what your server/app.js file might look like

```jsx
...
ampRoutes(app, {
  templates: {
    text: ({ story, config, relatedStories, infiniteScrollInlineConfig }) => (
      <CustomTextStoryTemplate
        story={story}
        config={config}
        relatedStories={relatedStories}
        infiniteScrollInlineConfig={infiniteScrollInlineConfig}>
    ),
    "live-blog": (props) => <CustomLiveBlogStoryTemplate {...props}>
  }
})
...
```

- pass a function that returns your template (react component)
- this function takes an object as a parameter having the foll keys:
  - `story` - <span id="storyConfig_link">the story object that platform gives</span>
  - `config` - an object containing `publisherConfig` and `ampConfig`. The `publisherConfig` is the same as response of _/api/v1/config_. The`ampConfig` is an amp-specific config given by _api/v1/amp/config_
  - `relatedStories` - contains stories from the related stories collection
  - `infiniteScrollInlineConfig` - contains inline config needed by amp infinite scroll
- `CustomTextStoryTemplate` is the template you've built using AMP library components and/or your own amp html. All your text stories will render this template.
- `text`, `live-blog` are the story template names. <b><em>They must match the `story-template` in platform's story api response</em></b>

<hr/>

#### Slots

<a id="slots_link" href="/story-page-slots.png" target="_blank">Image For Reference</a>

Slots can be thought of as windows that let you "slot in" whatever you need. In story page, we have two slots:

- **top slot** - placed just below the top ad
- **bottom slot** - placed just above the bottom ad

You might want to use slots to add ads, some scripts etc.
The `<Head />` component may be used to put code in the head. Using it, custom scripts, css can be added. It uses [react-helmet](https://www.npmjs.com/package/react-helmet)

Slots are nothing but functions that should return a react component.

```jsx
ampRoutes(app, {
   slots: {
     story: {
       "top-slot": ({story, config}) => <MyTopSlot story={story} config={config} />
       "bottom-slot": ({story, config}) => <MyBottomSlot story={story} config={config} />
     }
   }
})
```

Here, `story` and `config` is same as what's mentioned <a href="#storyConfig_link">above</a>.

#### Renders

If you wish to customize the default templates, you can do so using the various render prop overrides that the library provides. These too are functions that should return react components

For example,

```jsx
const mySERenders = {
  textElementRender: ({story, config, element}) => (<div>
    <span>My Custom Text Element</span>
    <div className="">{element.text}</div>
  </div>)
}
ampRoutes(app, {
   slots: {
     story: {
       "top-slot": ({story, config}) => <MyTopSlot story={story} config={config} />
       "bottom-slot": ({story, config}) => <MyBottomSlot story={story} config={config} />
     }
   }
})
```

Here too, `story` and `config` is same as what's mentioned <a href="#storyConfig_link">above</a>.

| Render prop name                                                        | children                  | props                                 | details                                                                                  |
| ----------------------------------------------------------------------- | ------------------------- | ------------------------------------- | ---------------------------------------------------------------------------------------- |
| headerCardRender                                                        | -                         | obj - {story, config}                 |                                                                                          |
| relatedStoriesRender                                                    | -                         | obj - {relatedStories, config, story} | `relatedStories` gives stories in the related stories collection                         |
| infiniteScrollRender                                                    | -                         | obj - {story, config, inlineConfig}   | `inlineConfig` is one part of the JSON config given to to the infinite scroll component. |
| <b>storyElementRender</b> (object containing all story element renders) | -                         | -                                     | -                                                                                        |
| ↳                                                                       | bigfactElementRender      | obj - {story, config, element}        | `element` is the story element, same as what's found in the story API                    |
| ↳                                                                       | answerElementRender       | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | questionElementRender     | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | summaryElementRender      | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | textElementRender         | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | youtubeElementRender      | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | vidibleElementRender      | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | twitterElementRender      | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | titleElementRender        | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | instagramElementRender    | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | imageGalleryElementRender | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | imageElementRender        | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | facebookElementRender     | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | embedRender               | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | dailyMotionRender         | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | blockquoteRender          | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | blurbRender               | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | alsoReadRender            | obj - {story, config, element}        | - _same_ -                                                                               |
