The AMP library accepts customizations via the "opts" javascript object.

# AMP story pages

The opts object for rendering AMP story pages has the following structure:

```jsx
const myOptsObj = {
  seo,
  templates: {
    text: ({ story, config, seo }) => <CustomTextTemplate story={story} config={config} seo={seo} />,
    video: ({ story, config, seo }) => <CustomVideoTemplate story={story} config={config} seo={seo} />
    // ... other templates
  },
  slots: {
    story: {
      "top-slot": ({ story, config }) => <MyTopSlot story={story} config={config} />,
      "bottom-slot": ({ story, config }) => <MyBottomSlot story={story} config={config} />
    }
  },
  render: {
    headerCardRender: ({ story, config }) => <CustHeaderCard story={story} config={config} />,
    infiniteScrollRender: ({ story, config, inlineConfig }) => <CustomInfiniteScroll story={story} config={config} firstFiveStoriesConfig={inlineConfig} />
    // ... other renders
    storyElementRender: {
      bigfactElementRender: ({ story, config, element }) => (
        <CustBigFact story={story} config={config} element={element} />
      )
      // ... other SE renders
    }
  },
  featureConfig: {}
};
```

- `seo` - this is the SEO object generated by [quintype/seo](https://developers.quintype.com/quintype-node-seo/)
- `templates` - pass your custom story templates here. If not passed, the default templates will be used
- `slots` - config for story page slots
- renders - umbrella term used for the different render props used to customize the default templates.
  - `storyElementRender`
  - `relatedStoriesRender`
  - `headerCardRender`
  - `infiniteScrollRender`
- `featureConfig` - used to provide config for amp lib features.

<hr />
This section is useful if you want to use custom templates. Else, jump to <a href="#slots_link">slots</a>

## Passing custom templates

Go to {@tutorial custom-story-templates}

<hr/>

## Slots

[Slots]{@link module:Slots} are nothing but functions that should return a react component.

You might want to use slots to add ads, some scripts etc.
The `<Head />` component may be used to put code in the head. Using it, custom scripts, css can be added. It uses [react-helmet](https://www.npmjs.com/package/react-helmet)

```jsx
ampRoutes(app, {
   slots: {
     story: {
       "top-slot": ({story, config}) => <MyTopSlot story={story} config={config} />
       "bottom-slot": ({story, config}) => <MyBottomSlot story={story} config={config} />
       "live-blog-card-slot": ({story, config, index, card}) => <MyLiveBlogCardSlot />
       "default-story-card-slot": ({story, config, index, card}) => <MyStoryCardSlot />
     }
   }
})
```

Here, `story` and `config` is same as what's mentioned <a href="#storyConfig_link">above</a>.

| Slot Name               | Slot Type | props                                      | description                                                                   |
| ----------------------- | --------- | ------------------------------------------ | ----------------------------------------------------------------------------- |
| top-slot                | story     | obj - {story, config}                      |                                                                               |
| bottom-slot             | story     | obj - {story, config}                      |                                                                               |
| live-blog-card-slot     | story     | obj - {story, config, index, card}         | card - the card above this slot. index - the 1st card has 0th index and so on |
| default-story-card-slot | story     | obj - {story, config, index, card}         | This slot is placed after every card on non-liveblog story templates          |
| related-story-card-slot | story     | obj - {story, config, index, relatedStory} | This slot is placed after every related story card (also read)                |

## Feature Config

Feature config is an object that can be used to configure different features of amp lib.

1. enableAds: used to enable/disable ads on different templates. `top`, `body` and `bottom` corresponds to top-ad, body-ad and bottom-ad respoectively. By default, the ads are shown if no featureConfig is given.
2. relatedStories (also read)
   - storiesToTake: sets the number of related stories displayed. Defaults to 5
3. infiniteScroll:
   - `storySeparatorText`: String that will be displayed by the separator that separates two infinite scroll stories. If nothing is passed, `SCROLL FOR NEXT` is displayed
4. sidebarMenu
   - Optional. To tell amplib from where to pick items for the sidebar (Hamburger) menu, pass the slug of that menu group to `opts.featureConfig.sidebarMenu.menuGroupSlug`
   - This can be extended to subdomains as well. For example if you have a subdomain called `world-news`, set `opts.domains["world-news"].featureConfig.sidebarMenu.menuGroupSlug`. Now the sidebar menu on the subdomain `world-news` will pick items from whatever menu group you've set
   - go to {@tutorial hamburger-menu} for more info
5. webengage
   - isEnabled: This is a toggle used to enable or disable the webengage.

```jsx
const exampleFeatureConfig = {
  enableAds: {
    default: {
      top: true / false,
      body: true / false,
      bottom: true / false
    },
    liveBlog: {
      top: true / false,
      body: true / false,
      bottom: true / false
    }
  },
  liveBlog: {
    dataPollInterval: "10000",
    dataMaxItemsPerPage: "50"
  },
  relatedStories: {
    storiesToTake: number
  infiniteScroll: {
    storySeparatorText: string
  },
  sidebarMenu: {
    menuGroupSlug: string
  },
  webengage:{
    isEnabled: boolean;
  }
};
```

## Renders

If you wish to customize the default templates, you can do so using the various render prop overrides that the library provides. These too are functions that should return react components

For example,

```jsx
ampRoutes(app, {
  render: {
    headerCardRender: ({story, config}) => <div>CUSTOM HEADER CARD</div>
    storyElementRender: {
      textElementRender: ({ story, config, element }) => (
        <div>
          <span>My Custom Text Element</span>
          <div className="">{element.text}</div>
        </div>
      )
    }
  }
});
```

Here too, `story` and `config` is same as what's mentioned <a href="#storyConfig_link">above</a>.

| Render prop name                                                        | children                  | props                                 | details                                                                                  |
| ----------------------------------------------------------------------- | ------------------------- | ------------------------------------- | ---------------------------------------------------------------------------------------- |
| headerCardRender                                                        | -                         | obj - {story, config}                 |                                                                                          |
| relatedStoriesRender                                                    | -                         | obj - {relatedStories, config, story} | `relatedStories` gives stories in the related stories collection                         |
| infiniteScrollRender                                                    | -                         | obj - {story, config, inlineConfig}   | `inlineConfig` is one part of the JSON config given to to the infinite scroll component. |
| <b>storyElementRender</b> (object containing all story element renders) | -                         | -                                     | -                                                                                        |
| ↳                                                                       | bigfactElementRender      | obj - {story, config, element}        | `element` is the story element, same as what's found in the story API                    |
| ↳                                                                       | answerElementRender       | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | questionElementRender     | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | qAndAElementRender        | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | summaryElementRender      | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | textElementRender         | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | youtubeElementRender      | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | vidibleElementRender      | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | twitterElementRender      | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | titleElementRender        | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | instagramElementRender    | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | imageGalleryElementRender | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | imageElementRender        | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | facebookElementRender     | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | embedRender               | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | dailyMotionRender         | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | blockquoteRender          | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | blurbRender               | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | alsoReadRender            | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | tableElementRender        | obj - {story, config, element}        | - _same_ -                                                                               |
| ↳                                                                       | unsupportedElementRender  | obj - {story, config, element}        | - _same_                                                                                 |
| liveBlogCardTimeStamp                                                   | -                         | obj - {story, config, card}           | `card` is the live blog card                                                             |
